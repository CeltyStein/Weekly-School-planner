  :root {
    --bg1:#d4b5f9; --bg2:#f9c5e5; --ink:#311a41; --card:#fff; --accent:#a855f7;
    --blue:#3b82f6; --green:#22c55e; --red:#ef4444; --amber:#f59e0b; --violet:#8b5cf6; --slate:#cbd5e1;
  }
  html,body{height:100%}
  body{ margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    color:var(--ink); background: linear-gradient(180deg,var(--bg1),var(--bg2)); }
  .wrap{max-width:1100px;margin:0 auto;padding:24px}
  header h1{margin:0;font-size:28px;letter-spacing:.02em;text-shadow:0 2px 3px rgba(255,255,255,.6)}
  header p{margin:6px 0 0;color:#475569;font-size:14px}
nav{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
.nav, nav, .controls, .view-controls{position:relative;z-index:5;}
.tab{border:2px solid #c084fc;background:#f3e8ff;color:var(--ink);padding:8px 12px;border-radius:12px;font-size:14px;cursor:pointer}
.tab[aria-selected="true"]{background:#e9d5ff;border-color:var(--accent)}
  .controls{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px;align-items:center}
  .toggle{display:flex;gap:8px;align-items:center;background:#fff8; padding:6px 10px; border-radius:10px; border:1px solid #e9d5ff}
.btn{background:#ede9fe;color:#6b21a8;border:1px solid #ddd;padding:8px 12px;border-radius:10px;cursor:pointer}
.btn:disabled{opacity:.6;cursor:not-allowed}
.dark-contrast .tab,
.dark-contrast .btn,
.dark-contrast .toggle{
  background:#111827;
  color:#f8fafc !important;
  border-color:#334155;
  box-shadow:0 8px 14px rgba(0,0,0,.25);
}
.dark-contrast .tab[aria-selected="true"]{
  background:#0b1220;
  border-color:#6366f1;
}
.dark-contrast .toggle{background:#111827;}
.dark-contrast .toggle span{color:#f8fafc;}
.grid{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:16px; margin-top:12px}
  @media(min-width:700px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
  @media(min-width:1024px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
  .card{
    position:relative;background:var(--card);border-radius:20px;border:3px solid transparent;
    box-shadow:0 4px 8px rgba(0,0,0,.05);padding-top:26px;padding-bottom:40px;overflow:visible;
    border-image: linear-gradient(45deg,#f9a8d4,#c084fc) 1;
  }
  .day{position:absolute;top:-20px;left:50%;transform:translateX(-50%);margin:0;background:#fff;border:2px solid var(--accent);border-radius:999px;
    width:78%;padding:6px 18px;text-align:center;font-weight:600;box-shadow:0 6px 12px rgba(168,85,247,.15)}
  .content{padding:36px 16px 12px}
  .title{font-weight:600;margin-bottom:8px;color:#6b21a8}
  .row{display:flex;gap:10px;align-items:flex-start;padding:10px 12px;margin:8px 0;border-radius:14px;background:#f8fbff;border:1px solid #e2e8f0;box-shadow:0 8px 14px rgba(0,0,0,.05);position:relative;cursor:grab}
  .row::before{content:"âœ¨";font-size:14px;position:absolute;left:10px;top:10px;}
  .row[data-tag="blue"]{background:#e0f2fe;border-color:#bfdbfe}
  .row[data-tag="blue"]::before{content:"ðŸ“˜";}
  .row[data-tag="green"]{background:#e7f9f0;border-color:#bbf7d0}
  .row[data-tag="green"]::before{content:"ðŸƒ";}
  .row[data-tag="red"]{background:#fff1f2;border-color:#fecdd3}
  .row[data-tag="red"]::before{content:"ðŸ½ï¸";}
  .row[data-tag="amber"]{background:#fef9c3;border-color:#fde68a}
  .row[data-tag="amber"]::before{content:"ðŸ§˜";}
  .row[data-tag="violet"]{background:#f3e8ff;border-color:#e9d5ff}
  .row[data-tag="violet"]::before{content:"ðŸŒ™";}
  .row textarea{flex:1;min-height:40px;font-size:14px;border:1px solid #e0cffc;border-radius:12px;background:#f8f5ff;padding:10px 12px;resize:vertical;box-shadow:inset 0 1px 2px rgba(0,0,0,.04)}
  .row .read{white-space:pre-wrap;font-size:14px;line-height:1.35;padding:8px 10px;border-radius:12px;background:rgba(255,255,255,.7);flex:1;}
  .remove{background:#fff;border:none;color:#a855f7;font-size:16px;cursor:pointer}
  .remove:disabled{opacity:.4;cursor:not-allowed}
  .addrow{background:#ede9fe;color:#6b21a8;border:1px solid #ddd;padding:6px 10px;border-radius:8px;cursor:pointer}
  .addrow:disabled{opacity:.6;cursor:not-allowed}
  .mood{display:flex;justify-content:center;gap:6px;padding:8px 0 12px}
  .mood span{cursor:pointer;font-size:20px;transition:transform .15s ease}
  .mood span:hover{transform:scale(1.2)}
  .mood .sel{transform:scale(1.35);filter:drop-shadow(0 0 2px rgba(168,85,247,.6))}
  .row.dragging{opacity:.6;}
  button,.tab,.btn,.addrow,.remove{
    transition:transform .15s ease,box-shadow .2s ease;
  }
  .btn-press{
    transform:translateY(1px) scale(.97);
    box-shadow:0 12px 25px rgba(49,26,65,.18) inset;
  }
  .day-toggle{background:#ede9fe;border:none;color:#6b21a8;border-radius:999px;padding:4px 10px;font-size:12px;margin:4px auto;display:none;}
  .card.collapsed .content{display:none;}
  .card.collapsed .day-toggle{transform:rotate(180deg);}
  .planner-exports{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px;}
  .view-controls{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px;}
  .view-controls .btn{font-size:13px;padding:6px 10px;}
  .mood span:focus-visible{outline:2px solid #a855f7;outline-offset:3px;}
  /* Decorations: use provided images, sized to fit */


  
.decor{position:fixed;z-index:3;pointer-events:none;animation:float 6s ease-in-out infinite;opacity:.95;filter: drop-shadow(0 2px 4px rgba(0,0,0,.15));}
#pglasses-icon{top:.5rem;left:.5rem;width:120px;height:auto}
#phone-icon{top:.5rem;right:1rem;width:88px;height:auto;transform:rotate(-6deg)}
  @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-10px)}100%{transform:translateY(0)}}
  .hidden{display:none!important}
  .note{font-size:12px;color:#475569}
  .toast{position:fixed;top:12px;left:50%;transform:translateX(-50%);background:#10b981;color:white;padding:10px 14px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,.15);z-index:50;opacity:0;transition:opacity .2s ease}
  .toast.show{opacity:1}
  .warn{background:#f59e0b}
  .err{background:#ef4444}
  .journal-card{margin-top:28px;padding:24px;border-radius:32px;background:linear-gradient(180deg,#ffe1f2,#e8ddff);box-shadow:0 30px 40px rgba(134,76,191,.25);border:1px solid rgba(255,255,255,.7);}
  .journal-card h3{margin:0 0 6px;font-size:20px;color:#79216d;}
  .journal-card p.help{margin:0 0 16px;font-size:13px;color:#5e4968;}
  .journal-form{display:grid;gap:12px;background:rgba(255,255,255,.92);border-radius:24px;padding:16px;border:1px solid #f6d5ff;}
  .journal-row{display:flex;flex-wrap:wrap;gap:12px;}
  .journal-form input,.journal-form select,.journal-form textarea{flex:1;min-width:140px;border:1px solid #e2c2f8;border-radius:10px;padding:10px;font-family:inherit;font-size:14px;background:#fff;}
  .journal-form textarea{min-height:80px;resize:vertical;}
  .journal-form button{align-self:flex-start;background:#f472b6;color:white;border:none;border-radius:12px;padding:10px 18px;font-weight:600;cursor:pointer;box-shadow:0 10px 20px rgba(244,114,182,.35);}
  .journal-feed{margin-top:18px;display:grid;gap:12px;}
  .journal-entry{background:rgba(255,255,255,.95);border-radius:18px;padding:14px;border:1px solid #f2e6ff;box-shadow:0 8px 18px rgba(95,63,116,.12);}
  .journal-entry h4{margin:0;font-size:16px;color:#6b21a8;}
  .journal-entry .meta{font-size:12px;color:#7c7491;margin:4px 0 10px;}
  .journal-empty{font-size:13px;color:#6b21a8;text-align:center;}
  .notes-card{margin-top:18px;padding:24px;border-radius:28px;background:#fff;border:2px solid #f3e8ff;box-shadow:0 20px 45px rgba(49,26,65,.15);}
  .notes-head{display:flex;flex-wrap:wrap;justify-content:space-between;gap:12px;}
  .notes-head h3{margin:0;font-size:22px;color:#6b21a8;}
  .notes-controls{display:flex;flex-wrap:wrap;gap:8px;}
  .notes-importer{margin:18px 0;display:grid;gap:8px;}
  .notes-importer textarea{width:100%;min-height:100px;border:1px solid #e0d7fc;border-radius:12px;padding:10px;font-family:inherit;font-size:14px;}
  .notes-feed{display:grid;gap:14px;}
  .note-entry{border:1px solid #e0d7fc;border-radius:16px;padding:14px;background:#fdfbff;}
  .note-entry h4{margin:0;font-size:16px;color:#4c1d95;}
  .note-meta{font-size:12px;color:#6b6b89;margin:4px 0 8px;}
  .notes-empty{font-size:13px;color:#6b6b89;text-align:center;padding:16px;border:1px dashed #d6c6ff;border-radius:14px;background:#fcfaff;}
  .habit-row{display:flex;flex-direction:column;gap:12px;padding:16px;border-radius:18px;border:1px solid #f5d9ff;background:#fff;box-shadow:0 10px 20px rgba(134,76,191,.08);}
  @media(min-width:700px){.habit-row{flex-direction:row;justify-content:space-between;align-items:center;}}
  .habit-info{display:flex;align-items:center;gap:10px;flex:1;}
  .habit-info input,.habit-info select{border:1px solid #e0c7ff;border-radius:10px;padding:6px 10px;font-size:14px;}
  .habit-days{display:flex;flex-wrap:wrap;gap:6px;align-items:center;}
  .habit-day{width:32px;height:32px;border-radius:50%;border:1px solid #e2e8f0;background:#fff;color:#6b21a8;font-weight:600;cursor:pointer;transition:.15s;box-shadow:0 4px 8px rgba(105,65,159,.12);}
  .habit-day.on{background:#a855f7;color:#fff;border-color:#9333ea;box-shadow:0 8px 14px rgba(168,85,247,.3);}
  .habit-empty{font-size:13px;color:#6b21a8;text-align:center;padding:18px;border-radius:14px;border:1px dashed #d5b4f3;background:#fff5ff;}
  .habit-history{display:flex;gap:6px;margin-top:6px;}
  .habit-history-day{width:18px;height:18px;border-radius:999px;border:1px solid #f5d9ff;background:#fdf5ff;box-shadow:0 2px 6px rgba(134,76,191,.12);}
  .habit-history-day.on{background:#a855f7;border-color:#a855f7;box-shadow:0 4px 12px rgba(168,85,247,.35);}
  .habit-streak{margin-left:auto;font-size:12px;color:#6b21a8;display:flex;flex-direction:column;align-items:flex-end;}
  .habit-streak-best{font-size:10px;color:#4c1d95;margin-top:2px;}
  .habit-streak-hub{margin-bottom:12px;padding:10px;border-radius:18px;background:#f8f2ff;border:1px solid #e0d7ff;display:flex;flex-direction:column;gap:8px;}
  .habit-streak-days{display:flex;gap:6px;flex-wrap:wrap;}
  .habit-streak-day{display:flex;flex-direction:column;align-items:center;gap:4px;width:52px;padding:6px;border-radius:12px;border:1px solid transparent;font-size:12px;background:#fff5ff;color:#6b21a8;}
  .habit-streak-day.on{background:#ecfdf3;border-color:#bbf7d0;color:#065f46;box-shadow:0 4px 12px rgba(34,197,94,.2);}
  .habit-streak-day .day-label{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.1em;}
  .habit-streak-day .fire-icon{font-size:18px;}
  .habit-streak-info{font-size:13px;color:#4c1d95;font-weight:600;}
  .streak-freeze-bar{background:#0f172a;color:#e2e8f0;border-radius:16px;padding:10px 12px;display:flex;flex-wrap:wrap;gap:10px;align-items:center;border:1px solid #1e293b;box-shadow:0 10px 22px rgba(15,23,42,.3);}
  .streak-freeze-bar .freeze-title{font-weight:700;font-size:15px;margin-bottom:2px;}
  .streak-freeze-bar .freeze-note{font-size:12px;color:#cbd5e1;}
  .streak-freeze-bar .freeze-actions{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-left:auto;}
  .streak-freeze-bar .freeze-count{background:#111827;padding:6px 10px;border-radius:10px;border:1px solid #1f2a44;font-weight:700;}
  .streak-freeze-bar .btn{background:#1f2937;color:#f8fafc;border-color:#334155;}
  .streak-freeze-bar .btn:disabled{opacity:.55;}
  #confetti-wrapper{pointer-events:none;position:fixed;inset:0;overflow:hidden;z-index:60;}
  .confetti-piece{position:absolute;top:-10px;width:10px;height:4px;border-radius:999px;opacity:0;animation:confetti-fall 2s linear forwards;}
  @keyframes confetti-fall{
    0%{opacity:1;transform:translateY(0) rotate(0deg);}
    100%{opacity:0;transform:translateY(100vh) rotate(360deg);}
  }

  /* Pomodoro timer */
  .pomo-card{background:#171a2b;color:#e8eaf6;border-radius:24px;padding:24px;margin-top:12px;box-shadow:0 18px 35px rgba(15,18,34,.45);}
  .pomo-header{display:flex;flex-wrap:wrap;justify-content:space-between;gap:12px;margin-bottom:18px;}
  .pomo-durations{margin-top:4px;font-size:13px;color:#a8acc7;}
  .pomo-focus-input{display:flex;align-items:center;gap:8px;font-size:14px;color:#e8eaf6;}
  .pomo-focus-input input{width:70px;padding:6px 8px;border-radius:10px;border:1px solid rgba(255,255,255,.25);background:#0f1222;color:#e8eaf6;}
  .pomo-layout{display:grid;grid-template-columns:1.1fr .9fr;gap:16px;}
  @media(max-width:900px){.pomo-layout{grid-template-columns:1fr;}}
  .pomo-panel,.pomo-side-card{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:18px;padding:18px;}
  .pomo-status{display:flex;justify-content:space-between;align-items:center;font-size:14px;color:#a8acc7;}
  .pomo-circle{width:200px;height:200px;margin:12px auto;border-radius:50%;background:conic-gradient(#7c8cff var(--deg,0deg),#1f2344 var(--deg,0deg));display:flex;align-items:center;justify-content:center;position:relative;transition:background .3s ease;box-shadow:0 10px 30px rgba(0,0,0,.35);}
  .pomo-circle::after{content:"";position:absolute;inset:18px;border-radius:50%;background:#0f1222;box-shadow:inset 0 2px 6px rgba(0,0,0,.55);}
  .pomo-time{font-size:64px;font-weight:700;text-align:center;font-variant-numeric:tabular-nums;margin:0;position:relative;z-index:1;}
  .pomo-progress{display:none;}
  .pomo-mode{text-align:center;color:#a8acc7;font-size:13px;margin:8px 0;}
  .pomo-dots{display:flex;gap:10px;justify-content:center;margin:12px 0;}
  .pomo-dot{width:16px;height:16px;border-radius:50%;background:#2a2f54;border:1px solid rgba(255,255,255,.25);}
  .pomo-dot.on{background:conic-gradient(from 180deg,#7c8cff,#39d98a);box-shadow:0 0 16px rgba(124,140,255,.4);}
  .pomo-controls-row{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:14px;}
  .pomo-btn{border:none;border-radius:12px;padding:10px 16px;font-weight:600;cursor:pointer;box-shadow:0 8px 16px rgba(0,0,0,.35);}
  .pomo-btn.primary{background:linear-gradient(180deg,#7c8cff,#4b56d6);color:white;}
  .pomo-btn.ghost{background:transparent;color:#e8eaf6;border:1px solid rgba(255,255,255,.25);box-shadow:none;}
  .pomo-btn.danger{background:#ff6b6b;color:white;}
  .pomo-side{display:grid;gap:12px;}
  .pomo-task-suggest{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;padding:12px;border-radius:14px;border:1px dashed rgba(255,255,255,.25);background:rgba(57,217,138,.08);font-size:14px;}
  .pomo-task-suggest strong{color:#d7ffe8;}
  .pomo-pill{padding:10px 12px;border-radius:14px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);display:flex;flex-direction:column;gap:4px;font-size:13px;}
  .pomo-pill.done{background:rgba(57,217,138,.18);border-color:#39d98a;}
  .pomo-check{display:flex;align-items:center;gap:6px;font-size:12px;color:#d7ffe8;margin-top:4px;}
  .pomo-check input{width:16px;height:16px;accent-color:#39d98a;}
  .pomo-shortcuts{display:grid;gap:8px;}
  .pomo-shortcuts div{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-radius:12px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);font-size:14px;}
  .pomo-shortcuts .kbd{background:#10122a;border-color:rgba(255,255,255,.15);color:#e8eaf6;}
  .pomo-side-card .note{color:#cbd5f5;margin-top:10px;font-size:12px;}
  .pomo-weekdays{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px;}
.pomo-weekday{width:30px;height:30px;border-radius:8px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.06);color:#e8eaf6;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.15s;}
.pomo-weekday.on{background:rgba(57,217,138,.22);border-color:#39d98a;box-shadow:0 0 10px rgba(57,217,138,.35);}

/* Class dashboard */
.class-dashboard{display:flex;flex-direction:column;gap:14px;background:rgba(255,255,255,.85);border:2px solid #f3e8ff;border-radius:18px;padding:16px;}
.class-filter{display:flex;flex-wrap:wrap;gap:8px;}
.class-tabs{display:flex;flex-wrap:wrap;gap:8px;}
.class-tab{border:2px solid #c084fc;background:#f9f5ff;color:#4c1d95;padding:8px 12px;border-radius:12px;cursor:pointer;font-weight:600;}
.class-tab.on{background:#e9d5ff;}
.class-card{background:white;border:2px solid #e5e7eb;border-radius:16px;padding:14px;box-shadow:0 6px 14px rgba(0,0,0,.05);}
.class-card-head{display:flex;align-items:center;justify-content:space-between;gap:12px;}
.class-term-pill{background:#eef2ff;color:#4338ca;border-radius:999px;padding:6px 10px;font-size:12px;font-weight:700;border:1px solid #c7d2fe;}
.class-assignments{display:flex;flex-direction:column;gap:10px;margin-top:10px;}
.class-assignment{border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px;background:#faf5ff;}
.class-assignment-title{font-weight:700;font-size:14px;color:#4c1d95;}
.class-assignment-meta{font-size:12px;color:#475569;margin-top:4px;}
.class-path-card{margin-top:10px;padding:14px;border-radius:18px;background:#0b1624;border:1px solid #13253d;box-shadow:0 14px 28px rgba(15,23,42,.35);color:#e2e8f0;position:relative;overflow:hidden;}
.class-path-card::after{content:"";position:absolute;inset:0;background:radial-gradient(circle at 20% 30%,rgba(168,85,247,.08),transparent 46%),radial-gradient(circle at 80% 80%,rgba(16,185,129,.08),transparent 50%);pointer-events:none;}
.class-path-head{display:flex;justify-content:space-between;gap:10px;align-items:center;}
.class-path-title{font-weight:800;letter-spacing:.03em;}
.class-path{display:flex;flex-direction:column;gap:18px;margin-top:12px;position:relative;}
.class-path::before{content:"";position:absolute;left:50%;top:18px;bottom:18px;width:4px;background:linear-gradient(180deg,#fbbf24,#22d3ee);opacity:.5;transform:translateX(-50%);border-radius:999px;}
.path-step{display:flex;align-items:center;gap:12px;position:relative;}
.path-step.alt{flex-direction:row-reverse;}
.path-connector{position:absolute;left:50%;bottom:-16px;transform:translateX(-50%);width:4px;height:22px;background:linear-gradient(180deg,#22d3ee,transparent);opacity:.7;}
.path-node{width:68px;height:68px;border-radius:999px;display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:800;color:#0f172a;background:#fef3c7;border:3px solid #fcd34d;box-shadow:0 8px 18px rgba(0,0,0,.35);}
.path-node.done{background:#16a34a;color:#ecfdf3;border-color:#86efac;box-shadow:0 10px 20px rgba(22,163,74,.35);}
.path-node.next{background:#38bdf8;color:#0b1727;border-color:#67e8f9;}
.path-label{background:rgba(255,255,255,.05);border:1px solid rgba(226,232,240,.12);padding:8px 10px;border-radius:12px;backdrop-filter:blur(6px);max-width:360px;}
.path-label strong{display:block;font-size:14px;color:#f8fafc;}
.path-label small{display:block;font-size:12px;color:#cbd5e1;margin-top:2px;}

.rpg-hud{display:flex;align-items:center;gap:10px;padding:8px 10px;border:2px solid #c084fc;border-radius:14px;background:#f8f5ff;box-shadow:0 6px 12px rgba(0,0,0,.06);}
.rpg-title{font-weight:700;color:#6b21a8;}
.rpg-level{font-weight:600;color:#4c1d95;}
.rpg-progress{display:flex;flex-direction:column;gap:4px;min-width:160px;}
.rpg-bar{height:10px;border-radius:999px;border:1px solid #d8b4fe;background:#f3e8ff;overflow:hidden;}
.rpg-bar span{display:block;height:100%;background:linear-gradient(90deg,#a855f7,#f472b6);}
.rpg-xp{font-size:12px;color:#475569;}

.daily-streak-chip{display:flex;align-items:center;gap:10px;min-width:220px;padding:8px 12px;border-radius:14px;border:2px solid #22c55e;background:linear-gradient(120deg,#bbf7d0,#bfdbfe);color:#064e3b;box-shadow:0 10px 18px rgba(59,130,246,.18);}
.daily-streak-icon{font-size:22px;line-height:1;}
.daily-streak-label{font-size:12px;font-weight:700;letter-spacing:.02em;text-transform:uppercase;}
.daily-streak-count{font-size:18px;font-weight:800;}
.daily-streak-meta{font-size:12px;color:#065f46;}
.dark-contrast .daily-streak-chip{background:linear-gradient(120deg,#0f172a,#0b1220);border-color:#10b981;color:#e2e8f0;box-shadow:0 14px 28px rgba(0,0,0,.35);}
.dark-contrast .daily-streak-meta{color:#a5f3fc;}

.file-input-hidden{position:absolute;left:-9999px;}
.file-label{cursor:pointer;}

.habit-card{padding:24px;background:#fff7ff;border-image:none;border:3px solid #f0d7ff;box-shadow:0 18px 35px rgba(134,76,191,.25);}
.habit-header{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:12px;margin-bottom:18px;}
.habit-title{margin:0;font-size:24px;color:#79216d;}
.habit-list{display:flex;flex-direction:column;gap:12px;}
.habit-actions{display:flex;flex-wrap:wrap;gap:8px;margin-top:18px;}

.settings-panel{display:flex;flex-direction:column;gap:12px;}
.card-persist{background:#fff7ff;border:3px solid #f3dcff;}
.card-reset{background:#fffdf7;border:3px solid #ffdcb8;}
.tight-heading{margin-top:0;margin-bottom:6px;}
.reset-btn{margin-top:8px;}

.danger-zone{margin-top:12px;background:linear-gradient(90deg,#f97316,#f43f5e);padding:10px 12px;border-radius:14px;box-shadow:0 10px 20px rgba(0,0,0,.12);color:#fff;display:flex;flex-direction:column;gap:8px;}
.danger-label{font-weight:800;letter-spacing:.08em;text-transform:uppercase;font-size:11px;}
.danger-list{display:flex;flex-direction:column;gap:8px;}
.danger-item{background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.25);border-radius:10px;padding:8px 10px;color:#fff;}
.danger-item.boss{border-color:#fff;box-shadow:0 0 0 2px rgba(255,255,255,.4);}
.danger-head{display:flex;align-items:center;justify-content:space-between;gap:10px;font-size:13px;}
.danger-title{font-weight:700;flex:1;}
.danger-status{font-weight:600;}
.danger-bar{margin-top:6px;height:8px;border-radius:999px;background:rgba(255,255,255,.3);overflow:hidden;}
.danger-bar span{display:block;height:100%;background:linear-gradient(90deg,#22c55e,#facc15);}
.danger-empty{color:#fff;font-weight:600;}
.danger-done-btn{background:rgba(255,255,255,.15);color:#fff;border:1px solid rgba(255,255,255,.35);padding:4px 8px;border-radius:8px;font-size:12px;cursor:pointer;}
.danger-done-btn:hover{background:rgba(255,255,255,.25);}
.danger-resource-card{background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.28);border-radius:12px;padding:10px 12px;display:flex;flex-direction:column;gap:8px;color:#fff;}
.resource-head{display:flex;justify-content:space-between;align-items:flex-end;gap:10px;flex-wrap:wrap;}
.resource-title{font-weight:800;letter-spacing:.02em;}
.resource-sub{font-size:12px;opacity:.85;}
.resource-grid{display:flex;flex-wrap:wrap;gap:10px;}
.resource-pill{flex:1;min-width:220px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.25);border-radius:10px;padding:10px;display:flex;flex-direction:column;gap:6px;}
.resource-label{font-weight:700;font-size:14px;}
.resource-note{margin:0;font-size:12px;opacity:.9;}
.resource-links{display:flex;gap:8px;flex-wrap:wrap;}
.resource-link{background:#fff;color:#0f172a;padding:6px 10px;border-radius:8px;font-weight:700;font-size:12px;text-decoration:none;box-shadow:0 6px 14px rgba(0,0,0,.18);}
.resource-link:hover{transform:translateY(-1px);}
.boss-card{margin-top:10px;background:rgba(0,0,0,.15);border:1px solid rgba(255,255,255,.4);border-radius:12px;padding:10px;box-shadow:0 10px 18px rgba(0,0,0,.18);color:#fff;}
.boss-head{display:flex;justify-content:space-between;align-items:center;font-weight:700;}
.boss-meta{font-size:12px;opacity:.9;}
.boss-visual{margin-top:8px;display:flex;align-items:center;gap:12px;}
.boss-monster{width:54px;height:54px;image-rendering:pixelated;background:linear-gradient(135deg,#a855f7,#ec4899);border:2px solid #fff;border-radius:8px;box-shadow:4px 6px 0 rgba(0,0,0,.25), inset 0 -6px 0 rgba(0,0,0,.2);}
.boss-monster::after{content:"";display:block;width:100%;height:100%;background:
  linear-gradient(90deg, transparent 45%, rgba(255,255,255,.4) 45%, rgba(255,255,255,.4) 55%, transparent 55%),
  linear-gradient(180deg, rgba(0,0,0,.25) 60%, transparent 60%);
}
.boss-bar{flex:1;height:12px;border-radius:999px;background:rgba(255,255,255,.25);overflow:hidden;border:1px solid rgba(255,255,255,.4);}
.boss-bar span{display:block;height:100%;background:linear-gradient(90deg,#22c55e,#facc15);}
.boss-note{font-size:12px;margin-top:8px;color:#f8fafc;}
.boss-attack{position:relative;display:block;}
.boss-attack.shell{width:12px;height:12px;border-radius:4px;background:#fbbf24;box-shadow:0 0 0 2px #78350f inset;animation:shootShell 1s ease-out forwards;}
.boss-attack.slash{width:36px;height:6px;background:linear-gradient(90deg,#f472b6,#a855f7);border-radius:3px;animation:slash 0.8s ease-out forwards;}
.boss-attack.blast{width:16px;height:16px;border-radius:50%;background:radial-gradient(circle,#22d3ee 0%,#0ea5e9 60%,transparent 100%);animation:blast 0.9s ease-out forwards;}
.boss-attack.spark{width:10px;height:10px;background:#facc15;border-radius:2px;box-shadow:0 0 10px #fde68a;animation:spark 0.7s ease-out forwards;}
@keyframes shootShell{0%{transform:translateX(-60px) translateY(-12px) scale(.8);opacity:0.8;}80%{opacity:1;}100%{transform:translateX(80px) translateY(6px) scale(1);opacity:0;}}
@keyframes slash{0%{transform:translateX(-50px) translateY(0) rotate(-6deg);opacity:1;}100%{transform:translateX(70px) translateY(-6px) rotate(6deg);opacity:0;}}
@keyframes blast{0%{transform:translateX(-40px) translateY(-10px) scale(.7);opacity:.9;}100%{transform:translateX(60px) translateY(0) scale(1.4);opacity:0;}}
@keyframes spark{0%{transform:translateX(-30px) translateY(-6px) scale(.5);opacity:1;}100%{transform:translateX(50px) translateY(4px) scale(1);opacity:0;}}

/* Threat card */
.threat-card{margin-top:8px;padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,.4);background:rgba(0,0,0,.15);color:#fff;box-shadow:0 10px 20px rgba(0,0,0,.2);}
.threat-head{display:flex;justify-content:space-between;align-items:center;font-weight:700;}
.threat-badge{padding:4px 10px;border-radius:999px;font-size:12px;border:1px solid rgba(255,255,255,.4);}
.threat-gauge{margin-top:8px;height:10px;border-radius:999px;background:rgba(255,255,255,.2);overflow:hidden;}
.threat-gauge span{display:block;height:100%;background:linear-gradient(90deg,#22c55e,#ef4444);}
.threat-detail{margin-top:6px;font-size:12px;opacity:.9;}
.threat-card.level-green .threat-badge{background:#16a34a;border-color:#22c55e;}
.threat-card.level-yellow .threat-badge{background:#f59e0b;border-color:#fbbf24;}
.threat-card.level-orange .threat-badge{background:#f97316;border-color:#fb923c;}
.threat-card.level-red .threat-badge{background:#ef4444;border-color:#f87171;animation:threatPulse 1.6s ease-in-out infinite;}
@keyframes threatPulse{0%{box-shadow:0 0 0 0 rgba(239,68,68,.5);}70%{box-shadow:0 0 0 12px rgba(239,68,68,0);}100%{box-shadow:0 0 0 0 rgba(239,68,68,0);}}

.reply-card{margin-top:10px;padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,.3);background:rgba(255,255,255,.08);color:#fff;display:flex;flex-direction:column;gap:8px;}
.reply-head{display:flex;justify-content:space-between;font-weight:700;}
.reply-meta{font-size:12px;opacity:.9;}
.reply-bar{height:10px;border-radius:999px;background:rgba(255,255,255,.2);overflow:hidden;}
.reply-bar span{display:block;height:100%;background:linear-gradient(90deg,#22c55e,#facc15);}
.reply-actions{display:flex;gap:8px;flex-wrap:wrap;}
.reply-actions .btn{padding:6px 10px;font-size:12px;}
.reply-note{font-size:12px;opacity:.9;}
.stability-strip{margin-top:8px;padding:10px;border-radius:12px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.3);color:#fff;display:flex;flex-direction:column;gap:6px;}
.stability-strip.hidden{display:none;}
.stability-head{display:flex;justify-content:space-between;font-weight:700;}
.stability-meta{font-size:12px;opacity:.9;}
.stability-bar{height:10px;border-radius:999px;background:rgba(255,255,255,.2);overflow:hidden;}
.stability-bar span{display:block;height:100%;background:linear-gradient(90deg,#22c55e,#22d3ee);}
.stability-note{font-size:12px;opacity:.9;}

/* Bunker Mode */
body.theme-bunker{
  background:radial-gradient(circle at 20% 20%,#1e2328 0%,#0d0f12 45%,#0a0c0f 100%);
  color:#e5e7eb;
  font-family:"Consolas","SFMono-Regular","JetBrains Mono",monospace;
}
body.theme-bunker .card,
body.theme-bunker .class-card,
body.theme-bunker .workout-table-card{
  background:linear-gradient(180deg,#111418,#0c0e11);
  border:1px solid #334155;
  color:#e2e8f0;
  box-shadow:0 16px 30px rgba(0,0,0,.45);
}
body.theme-bunker .tab,
body.theme-bunker .btn,
body.theme-bunker .toggle,
body.theme-bunker .addrow,
body.theme-bunker .remove{
  background:#0f172a;
  color:#e2e8f0;
  border:1px solid #475569;
  box-shadow:0 10px 24px rgba(0,0,0,.35);
}
body.theme-bunker .tab[aria-selected="true"]{
  background:#111827;
  border-color:#22d3ee;
  color:#c7d2fe;
}
body.theme-bunker .danger-zone{
  background:linear-gradient(135deg,#1f2937,#111827);
  border:1px solid #eab308;
}
body.theme-bunker .danger-item{background:rgba(234,179,8,.12);border-color:rgba(234,179,8,.5);}
body.theme-bunker .danger-bar{background:rgba(255,255,255,.15);}
body.theme-bunker .danger-bar span{background:linear-gradient(90deg,#22c55e,#eab308);}
body.theme-bunker .danger-resource-card{background:rgba(15,23,42,.75);border-color:rgba(241,245,249,.12);}
body.theme-bunker .resource-link{background:#0b1220;color:#e2e8f0;border:1px solid rgba(226,232,240,.2);}
body.theme-bunker .rpg-hud,
body.theme-bunker .ghost-card{background:#0b1220;border-color:#334155;color:#e2e8f0;}
body.theme-bunker .chatbot-panel{background:#0f172a;border-color:#334155;color:#e2e8f0;}
body.theme-bunker .chatbot-message.bot{background:#0b1220;color:#22d3ee;}
body.theme-bunker .chatbot-message.user{background:#1f2937;color:#fbbf24;}
body.theme-bunker .day{background:#0f172a;border-color:#22d3ee;color:#c7d2fe;}
body.theme-bunker .title{color:#eab308;}
body.theme-bunker .note{color:#94a3b8;}
body.theme-bunker:not(.bunker-no-flicker) .wrap::after{
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  background:repeating-linear-gradient(0deg,rgba(255,255,255,.02) 0,rgba(255,255,255,.02) 1px,transparent 2px,transparent 4px);
  mix-blend-mode:screen;
  animation:bunker-flicker 6s infinite ease-in-out;
}
@keyframes bunker-flicker{
  0%,100%{opacity:0.08;}
  10%{opacity:0.2;}
  20%{opacity:0.05;}
  35%{opacity:0.18;}
  50%{opacity:0.07;}
  65%{opacity:0.14;}
  80%{opacity:0.04;}
}
.danger-view{display:flex;flex-direction:column;gap:14px;}
.story-mode-card{margin-top:16px;padding:18px;background:#030712;border-radius:18px;border:1px solid rgba(15,23,42,.6);box-shadow:0 20px 40px rgba(2,6,23,.4);color:#e2e8f0;position:relative;overflow:hidden;z-index:1;}
.story-mode-card::after{content:"";position:absolute;inset:0;background:radial-gradient(circle at 20% 20%,rgba(250,204,21,.18),transparent 55%),radial-gradient(circle at 80% 10%,rgba(34,211,238,.18),transparent 65%);pointer-events:none;}
.story-mode-card > *{position:relative;z-index:1;}
.story-chip{margin:0;font-size:11px;text-transform:uppercase;letter-spacing:.15em;color:#f97316;}
.story-mode-head{display:flex;justify-content:space-between;align-items:flex-start;gap:12px;}
.story-mode-stage{font-weight:700;font-size:14px;padding:6px 12px;border-radius:999px;background:rgba(15,23,42,.6);border:1px solid rgba(148,163,184,.5);color:#f8fafc;}
.story-mode-text{margin:10px 0 8px;font-size:14px;line-height:1.4;}
.story-mode-list{margin:0;padding-left:16px;display:flex;flex-direction:column;gap:6px;font-size:13px;color:#cbd5f5;}
.story-mode-footer{margin-top:10px;font-size:12px;color:#cbd5f5;font-weight:600;}
.integration-card{margin-top:16px;padding:18px;background:#fff;border:2px solid #e2e8f0;border-radius:18px;display:flex;flex-direction:column;gap:14px;}
.integration-head{display:flex;justify-content:space-between;align-items:flex-start;gap:12px;}
.integration-list{display:flex;flex-direction:column;gap:10px;}
.integration-toggle{display:flex;justify-content:space-between;gap:12px;padding:10px;border-radius:12px;border:1px solid #e2e8f0;background:#f8fafc;font-size:13px;}
.integration-toggle strong{display:block;font-size:14px;color:#0f172a;}
.integration-toggle small{display:block;color:#475569;font-size:12px;margin-top:2px;max-width:360px;}
.integration-toggle input{width:20px;height:20px;}
.integration-note{margin:0;font-size:13px;color:#475569;}
.reflection-card{margin-top:16px;padding:18px;background:#fff;border-radius:18px;border:2px solid #e0e7ff;display:flex;flex-direction:column;gap:12px;}
.reflection-head{display:flex;justify-content:space-between;align-items:flex-start;gap:12px;}
.reflection-prompt{font-size:14px;color:#4338ca;margin:0;}
.reflection-card textarea{width:100%;min-height:120px;border-radius:12px;border:1px solid #cbd5f5;padding:12px;font-family:inherit;font-size:14px;resize:vertical;background:#f8f9ff;}
.reflection-foot{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;}
.reflection-meta{font-size:12px;color:#475569;}
.card-notify{position:relative;overflow:hidden;}
.mascot-wrap{display:flex;align-items:center;gap:12px;margin-top:10px;padding:10px;border:1px dashed #cbd5f5;border-radius:12px;background:#f8fafc;}
.mascot-art{width:72px;height:72px;image-rendering:pixelated;border-radius:14px;box-shadow:0 10px 20px rgba(0,0,0,.12);}
.mascot-copy{font-size:13px;color:#334155;}
.smart-pair-card,.daily-intel-card{margin-top:12px;padding:14px;border-radius:16px;border:1px solid #e2e8f0;background:#fbfdff;box-shadow:0 12px 24px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px;}
.smart-pair-head,.daily-intel-head{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.smart-pair-list,.intel-list{margin:0;padding-left:18px;color:#1e293b;font-size:13px;display:flex;flex-direction:column;gap:6px;}
.smart-chip{padding:4px 8px;border-radius:999px;background:#e0f2fe;color:#0ea5e9;font-weight:700;font-size:11px;text-transform:uppercase;letter-spacing:.08em;}
.wins-overlay{position:fixed;inset:0;background:rgba(15,23,42,.7);z-index:130;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .2s ease;}
.wins-overlay.show{opacity:1;pointer-events:auto;}
.wins-card{background:#0b1224;color:#e2e8f0;border:1px solid #1e293b;border-radius:22px;padding:20px;max-width:420px;width:90%;box-shadow:0 20px 40px rgba(0,0,0,.35);display:flex;flex-direction:column;gap:10px;}
.wins-card h3{margin:0;font-size:20px;}
.wins-card ul{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:6px;font-size:13px;}
.wins-close{align-self:flex-end;background:#f97316;color:#0b1224;border:none;padding:8px 14px;border-radius:10px;font-weight:700;cursor:pointer;}
.mini-session{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#f0f9ff;box-shadow:0 10px 20px rgba(0,0,0,.06);display:flex;flex-direction:column;gap:8px;}
.mini-head{display:flex;justify-content:space-between;align-items:center;gap:8px;}
.mini-steps{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:6px;font-size:13px;color:#0f172a;}
.mini-done{color:#16a34a;font-weight:700;}
.track-card{margin-top:14px;padding:14px;border-radius:16px;border:1px solid #e2e8f0;background:#fff;box-shadow:0 12px 20px rgba(0,0,0,.06);display:flex;flex-direction:column;gap:10px;}
.track-title{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.track-nodes{display:flex;flex-wrap:wrap;gap:10px;}
.track-node{padding:10px;border-radius:12px;border:1px solid #e2e8f0;min-width:140px;background:#f8fafc;}
.track-node strong{display:block;font-size:14px;margin-bottom:6px;}
.track-dots{display:flex;gap:6px;}
.track-dot{width:12px;height:12px;border-radius:999px;border:1px solid #94a3b8;background:#e2e8f0;cursor:pointer;transition:transform .15s ease;}
.track-dot.on{background:#22c55e;border-color:#22c55e;box-shadow:0 0 0 2px rgba(34,197,94,.2);}
.track-dot:hover{transform:scale(1.1);}
.prep-card{margin-top:14px;padding:14px;border-radius:16px;border:1px solid #e2e8f0;background:#fefce8;box-shadow:0 12px 20px rgba(0,0,0,.06);display:flex;flex-direction:column;gap:10px;}
.prep-head{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.prep-list{display:flex;flex-direction:column;gap:8px;font-size:14px;color:#0f172a;}
.prep-item{display:flex;align-items:center;gap:10px;}
.prep-item input{width:18px;height:18px;}
.prep-note{font-size:12px;color:#475569;}
.prep-done{color:#16a34a;font-weight:700;}
.gremlin-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fff0f5;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px;}
.gremlin-head{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.gremlin-face{font-size:28px;}
.gremlin-actions{display:flex;gap:8px;flex-wrap:wrap;}
.gremlin-crime{font-size:13px;color:#9f1239;}
.gremlin-sticker{position:absolute;top:6px;right:6px;font-size:18px;transform:rotate(-12deg);}
.ghost-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#f8fafc;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:6px;}
.ghost-row{display:flex;align-items:center;gap:8px;font-size:13px;color:#0f172a;}
.ghost-icon{font-size:18px;}
.ghost-task{background:rgba(255,255,255,.85);border:1px dashed #cbd5f5;border-radius:12px;padding:8px 10px;margin-top:8px;display:flex;flex-direction:column;gap:6px;box-shadow:0 6px 12px rgba(0,0,0,.05);opacity:.9;}
.ghost-task .title{font-weight:700;color:#0f172a;}
.ghost-task .actions{display:flex;gap:8px;flex-wrap:wrap;}
.ghost-task button{font-size:12px;padding:6px 10px;border-radius:10px;border:1px solid #e2e8f0;background:#ede9fe;color:#6b21a8;cursor:pointer;}
.ghost-task .note{font-size:12px;color:#475569;}
.chatbot-message.thinking{font-style:italic;opacity:.7;}
.chatbot-nudge{background:#1f2937;color:#f8fafc;border:2px solid #0ea5e9;border-radius:12px;padding:8px 10px;font-size:12px;box-shadow:0 12px 24px rgba(0,0,0,.2);max-width:280px;display:none;}
.chatbot-nudge.show{display:block;}
.crime-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fff7ed;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px;}
.crime-head{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.crime-form{display:flex;flex-direction:column;gap:8px;}
.crime-form textarea{width:100%;min-height:70px;border-radius:10px;border:1px solid #f59e0b;padding:10px;font-family:inherit;font-size:13px;background:#fff;}
.crime-response{font-size:13px;color:#9a3412;}
.theme-cyber-monk{--bg1:#0f172a;--bg2:#1f2937;--ink:#e5e7eb;--card:#111827;}
.theme-cyber-monk body{background:radial-gradient(circle at 20% 20%,#1f2937,#0f172a 50%);}
.theme-cyber-monk .card,.theme-cyber-monk .class-card,.theme-cyber-monk .workout-table-card{background:#111827;border-color:#1f2937;color:#e5e7eb;}
.theme-rainbow-confetti body{background:linear-gradient(135deg,#fda4af,#c4b5fd 40%,#6ee7b7 80%);}
.theme-rainbow-confetti .card,.theme-rainbow-confetti .class-card,.theme-rainbow-confetti .workout-table-card{background:#fff;border-image:linear-gradient(45deg,#f472b6,#22d3ee,#a7f3d0) 1;}
.duck-overlay{position:fixed;bottom:14px;right:14px;z-index:140;display:flex;align-items:center;gap:10px;background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:10px;box-shadow:0 12px 20px rgba(0,0,0,.12);}
.duck-face{font-size:28px;}
.duck-text{font-size:13px;color:#0f172a;max-width:220px;}
.universe-card{margin-top:14px;padding:14px;border-radius:16px;border:1px solid #e2e8f0;background:#f8fafc;box-shadow:0 10px 20px rgba(0,0,0,.06);}
.universe-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;}
.uni-col{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:12px;box-shadow:0 8px 14px rgba(0,0,0,.05);}
.uni-title{font-weight:700;margin-bottom:6px;}
.uni-item{font-size:13px;margin:4px 0;color:#0f172a;}
.learn-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#eef2ff;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px;}
.learn-head{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.learn-form{display:flex;gap:8px;align-items:center;}
.learn-form input{flex:1;padding:8px 10px;border-radius:10px;border:1px solid #c7d2fe;font-size:13px;}
.learn-quiz{font-size:13px;color:#312e81;background:#fff;border-radius:10px;padding:10px;border:1px dashed #c7d2fe;}
.emoji-toggle{margin-left:8px;}
.butler-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#f8f5ff;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;gap:10px;align-items:flex-start;}
.butler-avatar{font-size:26px;}
.butler-text{font-size:13px;color:#0f172a;}
.forbidden-notes{background:#f5f0e6 !important;border:2px solid #c58452 !important;color:#2b2b2b !important;font-family:"Georgia",serif !important;}
.forbidden-notes h3,.forbidden-notes h4{font-family:"Lucida Blackletter","Times New Roman",serif !important;letter-spacing:.05em;}
.forbidden-notes .note{color:#4a3424 !important;}
.chill-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #bae6fd;background:#ecfeff;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px;}
.chill-head{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.chill-timer{font-weight:700;color:#0369a1;}
.chill-log{width:100%;min-height:60px;border-radius:10px;border:1px solid #bae6fd;padding:10px;font-size:13px;}
.quest-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#f0fdf4;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:10px;}
.quest-head{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.quest-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:8px;}
.quest-grid input,.quest-grid textarea{width:100%;padding:8px 10px;border-radius:10px;border:1px solid #bbf7d0;font-size:13px;}
.quest-list{margin-top:8px;}
.quest-item{padding:8px;border-radius:10px;background:#fff;border:1px solid #e2e8f0;margin-bottom:6px;}
.roulette-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fef9c3;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:10px;}
.roulette-prompts{display:flex;flex-direction:column;gap:8px;}
.prompt{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:10px;}
.prompt textarea{width:100%;min-height:50px;border-radius:8px;border:1px solid #e2e8f0;padding:8px;font-size:13px;}
.stars{display:flex;gap:4px;}
.star{font-size:18px;cursor:pointer;}
.mistake-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fff1f2;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:10px;}
.mistake-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:8px;}
.mistake-grid textarea,.mistake-grid input{width:100%;padding:8px 10px;border-radius:10px;border:1px solid #fecdd3;font-size:13px;}
.mistake-list{display:flex;flex-direction:column;gap:6px;}
.mistake-item{background:#fff;border:1px solid #fecdd3;border-radius:12px;padding:10px;}
.fact-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fff;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px;}
.fact-head{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.fact-form{display:flex;gap:8px;flex-wrap:wrap;}
.fact-form input{flex:1;min-width:220px;padding:8px 10px;border-radius:10px;border:1px solid #e2e8f0;font-size:13px;}
.fact-list{display:flex;flex-direction:column;gap:6px;}
.fact-item{border:1px solid #e2e8f0;border-radius:10px;padding:8px;display:flex;justify-content:space-between;align-items:center;gap:8px;}
.fact-text{font-size:13px;color:#0f172a;}
.fact-blur{filter:blur(6px);}
.radar-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fff;box-shadow:0 8px 16px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:6px;}
.radar-item{display:flex;justify-content:space-between;align-items:center;gap:8px;}
.npc-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fffaf0;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;gap:10px;}
.npc-avatar{font-size:26px;}
.npc-text{font-size:13px;color:#0f172a;}
.cosmic-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#eef2ff;box-shadow:0 8px 16px rgba(0,0,0,.08);}
.ritual-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fff7ed;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px;}
.crimes-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#fff1f2;box-shadow:0 10px 18px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px;}
.chaos-card{margin-top:12px;padding:12px;border-radius:14px;border:1px solid #e2e8f0;background:#ecfeff;box-shadow:0 10px 18px rgba(0,0,0,.08);}
.celebration{position:fixed;inset:0;background:rgba(3,7,18,.75);display:flex;justify-content:center;align-items:center;z-index:120;transition:opacity .25s ease;}
.celebration.hidden{opacity:0;pointer-events:none;}
.celebration-card{position:relative;background:linear-gradient(135deg,#f97316,#facc15);color:#0f172a;padding:24px 28px;border-radius:28px;box-shadow:0 20px 48px rgba(0,0,0,.35);max-width:320px;text-align:center;}
.celebration-icon{font-size:48px;margin-bottom:10px;}
.celebration-card h3{margin:0;font-size:24px;}
.celebration-card p{margin:8px 0 14px;font-size:15px;line-height:1.4;}
.celebration-btn{background:#0f172a;color:#f8fafc;border:none;width:100%;font-weight:700;}
.celebration-orbs{position:absolute;inset:0;pointer-events:none;}
.celebration-orb{position:absolute;width:16px;height:16px;border-radius:999px;background:rgba(255,255,255,.8);animation:float-orb 3s ease-in-out infinite;}
.celebration-orb.orb-a{top:10%;left:18%;animation-delay:0s;}
.celebration-orb.orb-b{top:50%;right:12%;animation-delay:.4s;}
.celebration-orb.orb-c{bottom:12%;left:22%;animation-delay:.8s;}
@keyframes float-orb{0%{transform:translateY(0);}50%{transform:translateY(-12px) scale(1.1);}100%{transform:translateY(0);}}
.read.push{background:#fef3c7;border-radius:6px;padding:2px 4px;box-shadow:inset 0 0 0 1px #f59e0b33;}
.read.read{background:#e0f2fe;border-radius:6px;padding:2px 4px;box-shadow:inset 0 0 0 1px #38bdf833;}

.notes-hub{margin:12px 0;padding:14px;border-radius:14px;background:#f8fafc;border:1px solid #e2e8f0;box-shadow:0 10px 18px rgba(0,0,0,.06)}
.notes-hub-head{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}
.notes-hub-actions{display:flex;gap:6px;flex-wrap:wrap}
.notes-hub-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:8px;margin:8px 0}
.day-emoji-chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;margin-bottom:8px;border-radius:999px;background:rgba(255,255,255,0.85);border:1px solid rgba(0,0,0,0.05);font-weight:700;color:#111}

  /* Calendar */
  .calendar-card{background:#fff;border-radius:24px;padding:24px;margin-top:16px;border:3px solid #f3e8ff;box-shadow:0 18px 30px rgba(49,26,65,.18);}
  .calendar-controls{display:flex;flex-wrap:wrap;gap:12px;justify-content:space-between;align-items:center;}
  .calendar-controls .group{display:flex;flex-wrap:wrap;gap:8px;align-items:center;}
  .cal-date{border:1px solid #d8b4fe;border-radius:10px;padding:6px 10px;font-size:14px;}
  .cal-check{font-size:13px;display:flex;align-items:center;gap:4px;}
  .cal-import{position:relative;overflow:hidden;}
  .cal-import input{position:absolute;inset:0;opacity:0;cursor:pointer;}
  .calendar-ics-actions{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-top:6px;}
  .calendar-ics-note{margin-top:8px;}
  .cal-ics-status{border:1px dashed rgba(168,85,247,.5);border-radius:12px;padding:10px;font-size:13px;background:#fff8ff;color:#4c1d95;}
  .cal-ics-status.success{border-color:#34d399;background:#ecfdf3;color:#065f46;}
  .cal-ics-status.warn{border-color:#f59e0b;background:#fff7ed;color:#92400e;}
  .cal-chip{display:inline-flex;align-items:center;padding:6px 14px;border-radius:999px;background:#ede9fe;color:#6b21a8;font-size:13px;margin-top:12px;}
  .calendar-allrow{margin:12px 0;display:grid;grid-template-columns:120px repeat(7,1fr);gap:8px;}
  .calendar-allrow.hidden{display:none;}
  .calendar-allrow > div{background:#faf5ff;border:1px dashed #d8b4fe;border-radius:14px;padding:8px;min-height:60px;}
  .calendar-allrow > div:first-child{display:flex;align-items:center;justify-content:center;font-weight:600;}
  .cal{display:grid;grid-template-columns:120px repeat(7,1fr);border:1px solid #e2e8f0;border-radius:18px;overflow:hidden;}
  .cal-h{background:#fdf4ff;padding:10px;border-bottom:1px solid #e2e8f0;border-right:1px solid #e2e8f0;font-weight:600;text-align:center;}
  .cal-col{position:relative;height:1440px;border-right:1px solid #e2e8f0;background:#fff;}
  .cal-hour{height:60px;border-top:1px dashed #e2e8f0;}
  .event{position:absolute;left:6px;right:6px;border:1px solid #c4b5fd;border-radius:10px;padding:6px;font-size:12px;background:#ede9fe;box-shadow:0 6px 12px rgba(105,81,165,.16);overflow:hidden;}
  .cal-tag{display:inline-block;padding:4px 8px;margin:4px;border-radius:10px;background:#ede9fe;border:1px solid #d8b4fe;font-size:12px;color:#4c1d95;}

  /* Workout tab */
  .workout-tab{display:flex;flex-direction:column;gap:18px;margin-top:8px;}
  .workout-hero{background:linear-gradient(135deg,rgba(255,255,255,.95),#fff4fc);border-radius:28px;padding:20px 24px;border:2px solid #f9a8d4;box-shadow:0 18px 32px rgba(49,26,65,.12);}
  .workout-suptitle{margin:0;font-size:12px;letter-spacing:.18em;text-transform:uppercase;color:#a21caf;}
  .workout-hero h3{margin:6px 0 8px;font-size:24px;color:#4c1d95;}
  .workout-hero p{margin:0;color:#4b5563;font-size:14px;max-width:720px;}
  .workout-pill-row{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px;}
  .workout-pill{display:inline-flex;align-items:center;padding:6px 12px;border-radius:999px;border:1px solid #f3d1ff;background:#fef6ff;font-size:12px;font-weight:600;color:#6b21a8;}
  .workout-pill.accent{background:#fff1f7;border-color:#fecdd3;color:#b91c1c;}
  .workout-controls{display:flex;flex-wrap:wrap;gap:12px;align-items:center;padding:12px 16px;border-radius:20px;background:#fff;border:2px solid #f3e8ff;box-shadow:0 10px 24px rgba(49,26,65,.08);}
  .workout-toggle{display:flex;align-items:center;gap:8px;font-weight:600;color:#6b21a8;}
  .workout-toggle input{width:18px;height:18px;accent-color:#a855f7;}
  .workout-controls .note{margin-left:auto;font-size:12px;color:#475569;}
  @media(max-width:640px){ .workout-controls .note{flex-basis:100%;margin-left:0;} }
  .workout-section{background:rgba(255,255,255,.94);border-radius:28px;padding:20px;border:2px solid #f3e8ff;box-shadow:0 16px 30px rgba(49,26,65,.08);display:flex;flex-direction:column;gap:16px;}
  .workout-section-head{display:flex;flex-wrap:wrap;gap:12px;align-items:flex-start;}
  .workout-section-head h4{margin:0;font-size:20px;color:#4c1d95;}
  .workout-section-head p{margin:4px 0 0;color:#475569;font-size:14px;max-width:720px;}
  .workout-section-label{font-size:11px;text-transform:uppercase;letter-spacing:.18em;color:#a21caf;padding:6px 12px;border-radius:999px;background:#fdf4ff;border:1px solid #f3d1ff;font-weight:600;}
  .workout-table-card{background:#fff;border-radius:24px;padding:12px;border:1px solid #f3e8ff;}
  .workout-table-scroll{overflow-x:auto;}
  .workout-table{width:100%;border-collapse:separate;border-spacing:0;min-width:720px;}
  .workout-table thead th{background:#f7ecff;color:#4c1d95;font-weight:600;padding:10px;border:1px solid #edd3ff;text-align:left;font-size:13px;}
  .workout-table tbody th{background:#fdf7ff;color:#6b21a8;font-weight:600;padding:12px;border:1px solid #f3e8ff;font-size:13px;text-align:left;min-width:140px;}
  .workout-table td{vertical-align:top;padding:12px;border:1px solid #f7e8ff;font-size:13px;background:#fffbff;line-height:1.35;}
  .workout-table td .workout-pill{margin-bottom:6px;}
  .workout-editable[contenteditable="true"]{background:#fff7fb;border-color:#f0abfc;box-shadow:0 0 0 2px rgba(240,171,252,.2) inset;}
  .workout-note{background:#f8f5ff;border:1px dashed #d8b4fe;border-radius:12px;padding:8px;font-size:12px;color:#475569;}
  .workout-card-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;}
  .workout-card{background:#fff7ff;border:1px solid #f7d9ff;border-radius:22px;padding:16px;display:flex;flex-direction:column;gap:10px;box-shadow:0 8px 20px rgba(49,26,65,.08);}
  .workout-card h3{margin:0;font-size:18px;color:#4c1d95;}
  .workout-card p{margin:0;font-size:14px;color:#475569;}
  .workout-badges{display:flex;flex-wrap:wrap;gap:6px;}
  .workout-badge{font-size:11px;text-transform:uppercase;letter-spacing:.12em;background:#fff;border:1px solid #f3d1ff;color:#6b21a8;padding:4px 8px;border-radius:999px;font-weight:600;}
  .workout-card ul{margin:0;padding-left:18px;font-size:13px;color:#475569;display:flex;flex-direction:column;gap:4px;}
  .workout-card li.placeholder{color:#a855f7;font-style:italic;}
  .routine-card{background:#11162a;color:#e8eaf6;border:1px solid rgba(255,255,255,.08);border-radius:18px;padding:16px;box-shadow:0 16px 28px rgba(17,22,42,.3);}
  .routine-card h3{margin:0 0 6px;font-size:18px;color:#d7ffe8;}
  .routine-card p{margin:0 0 10px;font-size:14px;color:#cbd5f5;}
  .routine-tags{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px;}
  .routine-tag{font-size:11px;letter-spacing:.1em;text-transform:uppercase;padding:4px 8px;border-radius:999px;background:rgba(57,217,138,.18);color:#d7ffe8;border:1px solid rgba(57,217,138,.4);}
  .routine-note{font-size:12px;color:#cbd5f5;margin:10px 0 0;}
  .workout-editable{background:#fff7fb;border:1px dashed #f0abfc;border-radius:14px;padding:10px;box-shadow:0 4px 10px rgba(184,148,255,.15);cursor:grab;}
  .workout-editable:active{cursor:grabbing;}
  .workout-editable.dragging{opacity:.6;box-shadow:0 0 0 2px #a855f7 inset;}
  .workout-roadmap-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;}
  .workout-phase{background:#fff;border:1px solid #fde6ff;border-radius:24px;padding:18px;box-shadow:0 12px 26px rgba(49,26,65,.08);}
  .workout-phase h3{margin:0 0 4px;font-size:18px;color:#4c1d95;}
  .workout-phase .phase-range{font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.1em;color:#a21caf;margin-bottom:10px;}
  .workout-phase h4{margin:12px 0 4px;font-size:13px;text-transform:uppercase;color:#6b21a8;letter-spacing:.08em;}
  .workout-phase ul{margin:0 0 8px;padding-left:16px;font-size:13px;color:#475569;display:flex;flex-direction:column;gap:4px;}
  .workout-footnote{text-align:center;font-size:12px;color:#475569;margin-top:4px;}
  .roadmap-editor{display:flex;flex-direction:column;gap:14px;}
  .roadmap-card{background:#fff;border:1px solid #f3e8ff;border-radius:22px;padding:16px;box-shadow:0 12px 30px rgba(49,26,65,.1);display:flex;flex-direction:column;gap:10px;}
  .roadmap-card input,.roadmap-card textarea{width:100%;border:1px solid #e2d9fb;border-radius:10px;padding:8px;font-family:inherit;font-size:14px;background:#fffbff;}
  .roadmap-card textarea{min-height:80px;resize:vertical;}
  .roadmap-actions{display:flex;flex-wrap:wrap;gap:8px;}
  .skill-visualizer{margin-top:16px;display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;}
  .skill-card{background:#fff;border:1px solid #e2e8f0;border-radius:18px;padding:14px;box-shadow:0 10px 18px rgba(49,26,65,.08);}
  .skill-steps{display:flex;flex-direction:column;gap:6px;margin-top:10px;}
  .skill-step{display:flex;align-items:center;gap:8px;padding:6px;border-radius:10px;border:1px solid #e4e4f5;background:#faf5ff;font-size:13px;}
  .skill-step.done{border-color:#a855f7;background:#f3e8ff;font-weight:600;}
  .skill-step button{margin-left:auto;border:1px solid #d8b4fe;background:#fff;border-radius:999px;padding:4px 10px;font-size:12px;cursor:pointer;}
  /* Chatbot */
  .chatbot-widget{position:fixed;bottom:24px;right:24px;display:flex;flex-direction:column;align-items:flex-end;gap:10px;z-index:40;}
  .chatbot-toggle{background:#fff;border:2px solid #f3e8ff;border-radius:999px;padding:12px 18px;font-weight:600;color:#6b21a8;box-shadow:0 10px 25px rgba(49,26,65,.18);}
  .chatbot-panel{width:420px;max-width:90vw;background:#fff;border:2px solid #f3e8ff;border-radius:20px;box-shadow:0 18px 40px rgba(49,26,65,.25);padding:18px;display:flex;flex-direction:column;gap:12px;}
  .chatbot-header h4{margin:0;color:#6b21a8;}
  .chatbot-header p{margin:4px 0 0;font-size:13px;color:#475569;}
  .chatbot-messages{max-height:360px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;padding-right:4px;}
  .chatbot-message{padding:10px 14px;border-radius:16px;font-size:13px;line-height:1.35;box-shadow:0 4px 12px rgba(49,26,65,.12);}
  .chatbot-message.bot{background:#f5edff;color:#4c1d95;align-self:flex-start;}
  .chatbot-message.user{background:#fde3f1;color:#86198f;align-self:flex-end;}
  .chatbot-form{display:flex;gap:8px;}
  .chatbot-form input{flex:1;border:1px solid #e2e8f0;border-radius:999px;padding:8px 12px;font-size:14px;}
  .chatbot-form button{border-radius:999px;padding:8px 16px;}
  @media(max-width:640px){
    .chatbot-widget{right:12px;bottom:12px;width:calc(100% - 24px);}
    .chatbot-panel{width:100%;}
    nav{flex-direction:column;}
    .controls{flex-direction:column;align-items:flex-start;}
    .card{padding-bottom:20px;}
    .day-toggle{display:inline-block;}
    .workout-controls{flex-direction:column;align-items:flex-start;}
  }


.chatbot-message.thinking{font-style:italic;opacity:.7;}
.chatbot-nudge{background:#1f2937;color:#f8fafc;border:2px solid #0ea5e9;border-radius:12px;padding:8px 10px;font-size:12px;box-shadow:0 12px 24px rgba(0,0,0,.2);max-width:280px;display:none;}
.chatbot-nudge.show{display:block;}
.floating-ghost{position:fixed;z-index:99;min-width:220px;max-width:320px;background:rgba(15,23,42,.92);color:#e2e8f0;border:2px solid #a855f7;border-radius:12px;padding:10px;box-shadow:0 16px 32px rgba(0,0,0,.35);backdrop-filter:blur(2px);}
.floating-ghost .ghost-head{font-weight:700;margin-bottom:6px;display:flex;align-items:center;gap:6px;}
.floating-ghost .ghost-body{font-size:13px;}
.floating-ghost ul{margin:0;padding-left:16px;max-height:180px;overflow-y:auto;}
.floating-ghost .ghost-more{margin-top:6px;font-size:12px;opacity:.8;}

.daily-briefing{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:10px 12px;border-radius:12px;background:rgba(15,23,42,.85);color:#e2e8f0;border:1px solid #22d3ee;box-shadow:0 10px 22px rgba(0,0,0,.25);}
.daily-briefing.hidden{display:none;}
.daily-briefing .briefing-text{flex:1;font-size:13px;}
.briefing-view{padding:6px 10px;font-size:12px;}
.briefing-log{margin-top:8px;padding:10px;border-radius:12px;background:rgba(15,23,42,.9);color:#e2e8f0;border:1px solid #334155;max-height:220px;overflow-y:auto;}
.briefing-log.hidden{display:none;}
.briefing-log-list{display:flex;flex-direction:column;gap:6px;font-size:12px;}
.briefing-row{padding:6px 8px;border-radius:8px;background:rgba(255,255,255,.05);} 
.briefing-row.level-red{border:1px solid #ef4444;}
.briefing-row.level-orange{border:1px solid #f97316;}
.briefing-row.level-yellow{border:1px solid #facc15;}
.briefing-row.level-green{border:1px solid #22c55e;}
.briefing-close{margin-top:8px;}
.rooms-card{margin-top:8px;padding:10px;border-radius:12px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.3);color:#fff;}
.rooms-card.hidden{display:none;}
.rooms-head{font-weight:700;margin-bottom:6px;}
.rooms-list{display:flex;flex-direction:column;gap:6px;}
.room-row{display:grid;grid-template-columns:1fr 2fr auto;align-items:center;gap:8px;padding:6px;border-radius:8px;background:rgba(0,0,0,.12);border:1px solid rgba(255,255,255,.08);}
.room-row.low{border-color:#ef4444;}
.room-row.mid{border-color:#f59e0b;}
.room-row.ok{border-color:#22c55e;}
.room-name{font-weight:700;font-size:13px;}
.room-bar{height:8px;border-radius:999px;background:rgba(255,255,255,.18);overflow:hidden;}
.room-bar span{display:block;height:100%;background:linear-gradient(90deg,#22c55e,#facc15);}
.room-meta{font-size:12px;opacity:.9;text-align:right;}
.room-repair{padding:6px 8px;font-size:12px;}
